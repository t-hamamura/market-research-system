# 🔧 Market Research System - バグ修正作業環境

**ブランチ**: `bugfix/production-issues`  
**作成日**: 2024年7月2日  
**目的**: 本番テスト稼働で発見されたバグの分析・修正

## 📋 **作業環境の構成**

### 作成済みファイル
- `BUGFIX_WORKFLOW.md` - 修正作業の手順ガイド
- `bug_report_template.md` - バグレポート用テンプレート
- `debug_tools.py` - デバッグ・診断ツール
- `BUGFIX_README.md` - このファイル（作業環境説明）

### プロジェクト構成（確認済み）
- ✅ **TypeScriptコンパイル**: 正常
- ✅ **依存関係**: アップデート済み（脆弱性なし）
- ✅ **Git状態**: クリーン（不要ファイル削除済み）

## 🚀 **クイックスタート**

### 1. バグの情報収集
```bash
# バグレポートテンプレートを使用
cp bug_report_template.md bug_report_[日付].md
# → テンプレートに沿って情報を記入
```

### 2. 環境診断の実行
```bash
# デバッグツールを実行
python3 debug_tools.py

# または、特定URLでテスト
python3 debug_tools.py https://your-railway-app.up.railway.app
```

### 3. ローカル開発サーバー起動
```bash
# 開発モードで起動
npm run dev

# ブラウザで http://localhost:3000 にアクセス
```

### 4. 本番環境との比較
- ローカル環境でバグの再現を試行
- 本番環境特有の問題を特定

## 🔍 **バグ分析の流れ**

### Phase 1: 情報収集
1. **バグレポート作成** (`bug_report_template.md` 使用)
2. **環境診断実行** (`debug_tools.py` 使用)
3. **Railway ログ確認**
4. **ブラウザ Developer Tools 確認**

### Phase 2: 問題の特定
1. **ローカル環境での再現**
2. **コードの静的解析**
3. **依存関係の確認**
4. **API制限の調査**

### Phase 3: 修正実装
1. **対象ファイルの特定**
2. **修正コードの実装**
3. **ローカルテスト**
4. **エラーハンドリングの強化**

### Phase 4: 検証・デプロイ
1. **修正内容の確認**
2. **既存機能への影響調査**
3. **コミット・プッシュ**
4. **本番デプロイ・確認**

## 🛠️ **利用可能なツール**

### デバッグツール (`debug_tools.py`)
```bash
# 対話モード
python3 debug_tools.py

# 選択可能な診断:
# 1. 基本エンドポイントテスト
# 2. 調査フローシミュレーション  
# 3. 外部API依存関係チェック
# 4. 総合デバッグレポート
```

### 開発サーバー
```bash
# 開発モード（ホットリロード）
npm run dev

# 本番ビルド確認
npm run build
npm start
```

### テストコマンド
```bash
# TypeScript 型チェック
npx tsc --noEmit

# 依存関係の脆弱性チェック
npm audit

# ESLint（設定されている場合）
npx eslint src/
```

## 📊 **よくあるバグパターン**

### API関連
- **Gemini API制限**: 1分間60リクエスト上限
- **Notion API制限**: 1秒間3リクエスト上限
- **タイムアウト**: 30秒以上の長時間処理

### フロントエンド
- **JavaScript エラー**: Console ログで確認
- **UI応答性**: ローディング状態の表示
- **ブラウザ互換性**: 最新ブラウザでの動作確認

### バックエンド
- **TypeScript コンパイルエラー**: `npm run build` で確認
- **メモリ使用量**: Railway でのリソース制限
- **環境変数**: Railway での設定確認

### Notion連携
- **ページ作成失敗**: データベース権限の確認
- **データ形式エラー**: スキーマ検証の実装
- **重複作成**: 一意性チェックの強化

## 📞 **サポートリソース**

### ドキュメント
- `BUGFIX_WORKFLOW.md` - 詳細な修正手順
- `DEPLOYMENT_CHECKLIST.md` - デプロイ前確認事項
- `README.md` - プロジェクト全体概要

### 外部リソース
- **Railway Dashboard**: デプロイ・ログ確認
- **Notion API Docs**: https://developers.notion.com/
- **Gemini API Docs**: https://ai.google.dev/docs
- **TypeScript Docs**: https://www.typescriptlang.org/docs/

## 🚨 **注意事項**

### セキュリティ
- **API キー**: `.env` ファイルから漏洩させない
- **ログ**: 機密情報を含むログの取り扱い注意
- **コミット**: 環境変数をコミットしない

### 品質保証
- **破壊的変更**: 既存機能への影響を最小限に
- **バックワード互換性**: API仕様の変更を避ける
- **エラーハンドリング**: 適切な例外処理を実装

### 本番環境
- **段階的デプロイ**: 修正の影響範囲を考慮
- **ロールバック準備**: 問題発生時の復旧手順
- **監視**: デプロイ後の動作確認

---

**🎯 目標**: 迅速で確実なバグ修正により、システムの安定性と信頼性を向上させる

**📈 成功指標**: 
- バグの完全解決
- 既存機能への影響ゼロ
- 再発防止策の実装
- ユーザー体験の向上 